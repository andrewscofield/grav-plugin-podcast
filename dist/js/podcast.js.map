{"version":3,"sources":["node_modules/browser-pack/_prelude.js","assets/js/player.js","assets/js/podcast.js"],"names":[],"mappings":"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","file":"podcast.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","exports.PodcastPlayer = class{\r\n  \r\n    constructor(player_element, offset = 0){\r\n      this.isPlaying = false;\r\n      this.src;\r\n      this.progress;\r\n      this.currentTime = 0;\r\n      this.timeLeft = 0;\r\n      this.timeOffset = offset;\r\n\r\n      //setting up elements\r\n      this.player = player_element;\r\n      this.audio = this.player.querySelector('.podcast-player-audio');\r\n      this.play_button = this.player.querySelector('.podcast-play-button');\r\n      this.pause_button = this.player.querySelector('.podcast-pause-button');\r\n      this.bar = this.player.querySelector('.podcast-player-progress');\r\n      this.progress = this.player.querySelector('.podcast-player-progress-bar');\r\n      this.time = this.player.querySelector('.podcast-player-progress-time');\r\n  \r\n      //attach this to the dom so its accesible externally\r\n      this.player.podcastplayer = this;\r\n  \r\n      this.init();\r\n    }\r\n  \r\n  \r\n    init() {\r\n  \r\n      //setup native audio event listeners\r\n      this.audio.addEventListener('loadedmetadata', e => this.onCanPlay(e) );\r\n      this.audio.addEventListener('playing', e => this.onPlaying(e) );\r\n      this.audio.addEventListener('pause', e => this.onPause(e) );\r\n      this.audio.addEventListener('ended', e => this.onEnd(e) );\r\n      this.audio.addEventListener('error', e => this.onError(e) );\r\n  \r\n      // apply the audio start time property\r\n      this.audio.currentTime = this.timeOffset; \r\n\r\n      //setup click listeners\r\n      this.play_button.addEventListener('click', e => this.playPause(e));\r\n      this.pause_button.addEventListener('click', e => this.playPause(e));\r\n      this.bar.addEventListener('click', e => this.barClick(e));\r\n  \r\n      //setup global array of players \r\n      if(!window.podcast_players){\r\n        window.podcast_players = [];\r\n      }\r\n      window.podcast_players.push(this.player);\r\n    }\r\n  \r\n    playPause(e){\r\n      if (!!e) e.preventDefault();\r\n  \r\n      this.player.classList.toggle('playing');\r\n  \r\n      if (this.canBePlayed) {\r\n        if (this.isPlaying) {\r\n          this.pause();\r\n        } else {\r\n          this.play();\r\n        }\r\n      }\r\n      else if (this.preload === 'none') {\r\n        // If player can't be played, because audio wasn't pre-loaded\r\n        // due to the preload=\"none\" property set,\r\n        // load the audio file at this point and start playing it immediately\r\n        this.audio.load();\r\n        this.play();\r\n      }\r\n    }\r\n\r\n    stopAllPlayers(current){\r\n      for(let player of window.podcast_players){\r\n        if(player != current){\r\n          player.podcastplayer.pause();\r\n        }\r\n      }\r\n    }\r\n  \r\n    play() {\r\n      if(!this.player.classList.contains('played')){\r\n        this.player.classList.add('played');\r\n      }\r\n      this.stopAllPlayers(this.player);\r\n      this.player.classList.add('playing');\r\n      this.audio.play();\r\n    }\r\n    \r\n    pause() {\r\n      this.player.classList.remove('playing');\r\n      this.audio.pause();\r\n    }\r\n  \r\n  \r\n    // Restart audio\r\n    restart(e){\r\n      if (!!e) e.preventDefault();\r\n  \r\n      this.currentTime = 0;\r\n      if (!this.isPlaying) this.play();\r\n    }\r\n  \r\n  \r\n    // when audio file can be played in user's browser\r\n    onCanPlay() {\r\n      this.canBePlayed = true;\r\n      this.timeLeft = this.audio.duration;\r\n      var percentagePlayed = 0;\r\n  \r\n      // If player has a time offset specified\r\n      // style the progress bar and title accordingly\r\n      if (this.timeOffset > 0) {\r\n        var percentagePlayed = this.timeOffset / this.audio.duration;\r\n      }\r\n  \r\n      this.updateVisualProgress(percentagePlayed);\r\n    }\r\n  \r\n    // when player starts playing\r\n    onPlaying(){\r\n      this.ended = false;\r\n      this.isPlaying = true;\r\n      this.startProgressTimer();\r\n    }\r\n  \r\n  \r\n    // starts timer\r\n    startProgressTimer() {\r\n      this.timer = {};\r\n  \r\n      if (this.timer.sliderUpdateInterval) {\r\n        clearInterval(this.timer.sliderUpdateInterval);\r\n      }\r\n  \r\n      this.timer.sliderUpdateInterval = setInterval( () => {\r\n        if ( this.isPlaying ) {\r\n          this.currentTime = this.audio.currentTime;\r\n          this.timeLeft = this.audio.duration - this.currentTime;\r\n          var percentagePlayed = this.currentTime / this.audio.duration;\r\n          this.updateVisualProgress(percentagePlayed);\r\n        } \r\n        else {\r\n          clearInterval(this.timer.sliderUpdateInterval);\r\n        }\r\n      }, 60);\r\n    }\r\n  \r\n  \r\n    // when Player is paused\r\n    onPause() {\r\n      this.isPlaying = false;\r\n    }\r\n  \r\n  \r\n    // when Player ended playing an audio file\r\n    onEnd() {\r\n      this.ended = true;\r\n      this.isPlaying = false;\r\n    }\r\n  \r\n  \r\n    // on file load error\r\n    onError() {\r\n      this.player.classList.add('cantplay');\r\n      this.error = true;\r\n      this.player.setAttribute('aria-invalid', 'true');\r\n    }\r\n  \r\n  \r\n    // to convert seconds to 'm:ss' format\r\n    convertSecToMin(seconds){\r\n      if (seconds === 0) return '0:00';\r\n      var minutes = Math.floor(seconds / 60);\r\n      var secondsToCalc = Math.floor(seconds % 60) + '';\r\n      return minutes + ':' + (secondsToCalc.length < 2 ? '0' + secondsToCalc : secondsToCalc);\r\n    }\r\n  \r\n  \r\n    // When user clicks somewhere on the progress bar\r\n    barClick(e) {\r\n      e.preventDefault();\r\n  \r\n      if (this.canBePlayed) {\r\n        this.updateProgressBar(e);\r\n        if (!this.isPlaying) {\r\n          this.play();\r\n        }\r\n      }\r\n      else if (this.preload === 'none') {\r\n        this.audio.load();\r\n        this.audio.addEventListener('loadedmetadata', () => {\r\n          this.updateProgressBar(e);\r\n          if (!this.isPlaying) {\r\n            this.play();\r\n          }\r\n        }, false);\r\n      }\r\n    }\r\n  \r\n\r\n    // Helper function\r\n    // that recalculates the progress bar position\r\n    // based on the event.click position\r\n    updateProgressBar(e) {\r\n      var x = e.x - this.bar.getBoundingClientRect().left;\r\n      var r = (x / this.bar.getBoundingClientRect().width) * this.audio.duration;\r\n      this.updatePlayPosition(r);\r\n    }\r\n    \r\n    \r\n    // Helper function\r\n    // updates the current time based on a time variable\r\n    updatePlayPosition(newTime) {\r\n      this.currentTime = this.audio.currentTime = newTime;\r\n      var percentagePlayed = this.currentTime / this.audio.duration;\r\n      this.updateVisualProgress(percentagePlayed);\r\n    }\r\n    \r\n    \r\n    // Helper function\r\n    // updates the progress bar based on a percentage played\r\n    updateVisualProgress(percentagePlayed) {\r\n      this.progress.style.width = (percentagePlayed * 100) + '%';\r\n      this.time.innerHTML = this.convertSecToMin(this.timeLeft);\r\n    }\r\n  \r\n  };","import { PodcastPlayer } from './player'\r\n\r\nvar docReady = function(){\r\n  let players = document.querySelectorAll('.podcast-player');\r\n  for(var player of players){\r\n    var player = new PodcastPlayer(player);\r\n  }\r\n};\r\n\r\n\r\nif ( document.readyState === 'complete' || (document.readyState !== 'loading' && !document.documentElement.doScroll)) {\r\n  docReady();\r\n} \r\nelse {\r\n  document.addEventListener('DOMContentLoaded', docReady);\r\n}\r\n\r\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHNcXGpzXFxwbGF5ZXIuanMiLCJhc3NldHNcXGpzXFxwb2RjYXN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDQUEsUUFBQSxBQUFRLDRCQUVKO2tCQUFBLEFBQVksZ0JBQTJCO1FBQVgsQUFBVyw2RUFBRixBQUFFOzswQkFDckM7O1NBQUEsQUFBSyxZQUFMLEFBQWlCLEFBQ2pCO1NBQUEsQUFBSyxBQUNMO1NBQUEsQUFBSyxBQUNMO1NBQUEsQUFBSyxjQUFMLEFBQW1CLEFBQ25CO1NBQUEsQUFBSyxXQUFMLEFBQWdCLEFBQ2hCO1NBQUEsQUFBSyxhQUFMLEFBQWtCLEFBRWxCOztBQUNBO1NBQUEsQUFBSyxTQUFMLEFBQWMsQUFDZDtTQUFBLEFBQUssUUFBUSxLQUFBLEFBQUssT0FBTCxBQUFZLGNBQXpCLEFBQWEsQUFBMEIsQUFDdkM7U0FBQSxBQUFLLGNBQWMsS0FBQSxBQUFLLE9BQUwsQUFBWSxjQUEvQixBQUFtQixBQUEwQixBQUM3QztTQUFBLEFBQUssZUFBZSxLQUFBLEFBQUssT0FBTCxBQUFZLGNBQWhDLEFBQW9CLEFBQTBCLEFBQzlDO1NBQUEsQUFBSyxNQUFNLEtBQUEsQUFBSyxPQUFMLEFBQVksY0FBdkIsQUFBVyxBQUEwQixBQUNyQztTQUFBLEFBQUssV0FBVyxLQUFBLEFBQUssT0FBTCxBQUFZLGNBQTVCLEFBQWdCLEFBQTBCLEFBQzFDO1NBQUEsQUFBSyxPQUFPLEtBQUEsQUFBSyxPQUFMLEFBQVksY0FBeEIsQUFBWSxBQUEwQixBQUV0Qzs7QUFDQTtTQUFBLEFBQUssT0FBTCxBQUFZLGdCQUFaLEFBQTRCLEFBRTVCOztTQUFBLEFBQUssQUFDTjtBQXZCTDs7O1NBQUE7MkJBMEJXO2tCQUVMOztBQUNBO1dBQUEsQUFBSyxNQUFMLEFBQVcsaUJBQVgsQUFBNEIsa0JBQWtCLGFBQUE7ZUFBSyxNQUFBLEFBQUss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YSxBQUFrQixBQUNoQztBQUpzQjtnQkFBQTt3QkFBQTtxQkFBQTtZQUFBO1FBQUE7MERBQUE7a0JBQUE7QUFBQTtjQUFBOzZCQUFBO2NBQUE7QUFBQTtBQUFBO0FBS3hCO0FBTEQ7O0FBUUEsSUFBSyxTQUFBLEFBQVMsZUFBVCxBQUF3QixjQUFlLFNBQUEsQUFBUyxlQUFULEFBQXdCLGFBQWEsQ0FBQyxTQUFBLEFBQVMsZ0JBQTNGLEFBQTJHLFVBQVcsQUFDcEg7QUFDRDtBQUZELE9BR0ssQUFDSDtXQUFBLEFBQVMsaUJBQVQsQUFBMEIsb0JBQTFCLEFBQThDLEFBQy9DIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsImV4cG9ydHMuUG9kY2FzdFBsYXllciA9IGNsYXNze1xyXG4gIFxyXG4gICAgY29uc3RydWN0b3IocGxheWVyX2VsZW1lbnQsIG9mZnNldCA9IDApe1xyXG4gICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnNyYztcclxuICAgICAgdGhpcy5wcm9ncmVzcztcclxuICAgICAgdGhpcy5jdXJyZW50VGltZSA9IDA7XHJcbiAgICAgIHRoaXMudGltZUxlZnQgPSAwO1xyXG4gICAgICB0aGlzLnRpbWVPZmZzZXQgPSBvZmZzZXQ7XHJcblxyXG4gICAgICAvL3NldHRpbmcgdXAgZWxlbWVudHNcclxuICAgICAgdGhpcy5wbGF5ZXIgPSBwbGF5ZXJfZWxlbWVudDtcclxuICAgICAgdGhpcy5hdWRpbyA9IHRoaXMucGxheWVyLnF1ZXJ5U2VsZWN0b3IoJy5wb2RjYXN0LXBsYXllci1hdWRpbycpO1xyXG4gICAgICB0aGlzLnBsYXlfYnV0dG9uID0gdGhpcy5wbGF5ZXIucXVlcnlTZWxlY3RvcignLnBvZGNhc3QtcGxheS1idXR0b24nKTtcclxuICAgICAgdGhpcy5wYXVzZV9idXR0b24gPSB0aGlzLnBsYXllci5xdWVyeVNlbGVjdG9yKCcucG9kY2FzdC1wYXVzZS1idXR0b24nKTtcclxuICAgICAgdGhpcy5iYXIgPSB0aGlzLnBsYXllci5xdWVyeVNlbGVjdG9yKCcucG9kY2FzdC1wbGF5ZXItcHJvZ3Jlc3MnKTtcclxuICAgICAgdGhpcy5wcm9ncmVzcyA9IHRoaXMucGxheWVyLnF1ZXJ5U2VsZWN0b3IoJy5wb2RjYXN0LXBsYXllci1wcm9ncmVzcy1iYXInKTtcclxuICAgICAgdGhpcy50aW1lID0gdGhpcy5wbGF5ZXIucXVlcnlTZWxlY3RvcignLnBvZGNhc3QtcGxheWVyLXByb2dyZXNzLXRpbWUnKTtcclxuICBcclxuICAgICAgLy9hdHRhY2ggdGhpcyB0byB0aGUgZG9tIHNvIGl0cyBhY2Nlc2libGUgZXh0ZXJuYWxseVxyXG4gICAgICB0aGlzLnBsYXllci5wb2RjYXN0cGxheWVyID0gdGhpcztcclxuICBcclxuICAgICAgdGhpcy5pbml0KCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgXHJcbiAgICBpbml0KCkge1xyXG4gIFxyXG4gICAgICAvL3NldHVwIG5hdGl2ZSBhdWRpbyBldmVudCBsaXN0ZW5lcnNcclxuICAgICAgdGhpcy5hdWRpby5hZGRFdmVudExpc3RlbmVyKCdsb2FkZWRtZXRhZGF0YScsIGUgPT4gdGhpcy5vbkNhblBsYXkoZSkgKTtcclxuICAgICAgdGhpcy5hdWRpby5hZGRFdmVudExpc3RlbmVyKCdwbGF5aW5nJywgZSA9PiB0aGlzLm9uUGxheWluZyhlKSApO1xyXG4gICAgICB0aGlzLmF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ3BhdXNlJywgZSA9PiB0aGlzLm9uUGF1c2UoZSkgKTtcclxuICAgICAgdGhpcy5hdWRpby5hZGRFdmVudExpc3RlbmVyKCdlbmRlZCcsIGUgPT4gdGhpcy5vbkVuZChlKSApO1xyXG4gICAgICB0aGlzLmF1ZGlvLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgZSA9PiB0aGlzLm9uRXJyb3IoZSkgKTtcclxuICBcclxuICAgICAgLy8gYXBwbHkgdGhlIGF1ZGlvIHN0YXJ0IHRpbWUgcHJvcGVydHlcclxuICAgICAgdGhpcy5hdWRpby5jdXJyZW50VGltZSA9IHRoaXMudGltZU9mZnNldDsgXHJcblxyXG4gICAgICAvL3NldHVwIGNsaWNrIGxpc3RlbmVyc1xyXG4gICAgICB0aGlzLnBsYXlfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB0aGlzLnBsYXlQYXVzZShlKSk7XHJcbiAgICAgIHRoaXMucGF1c2VfYnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB0aGlzLnBsYXlQYXVzZShlKSk7XHJcbiAgICAgIHRoaXMuYmFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB0aGlzLmJhckNsaWNrKGUpKTtcclxuICBcclxuICAgICAgLy9zZXR1cCBnbG9iYWwgYXJyYXkgb2YgcGxheWVycyBcclxuICAgICAgaWYoIXdpbmRvdy5wb2RjYXN0X3BsYXllcnMpe1xyXG4gICAgICAgIHdpbmRvdy5wb2RjYXN0X3BsYXllcnMgPSBbXTtcclxuICAgICAgfVxyXG4gICAgICB3aW5kb3cucG9kY2FzdF9wbGF5ZXJzLnB1c2godGhpcy5wbGF5ZXIpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgcGxheVBhdXNlKGUpe1xyXG4gICAgICBpZiAoISFlKSBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgXHJcbiAgICAgIHRoaXMucGxheWVyLmNsYXNzTGlzdC50b2dnbGUoJ3BsYXlpbmcnKTtcclxuICBcclxuICAgICAgaWYgKHRoaXMuY2FuQmVQbGF5ZWQpIHtcclxuICAgICAgICBpZiAodGhpcy5pc1BsYXlpbmcpIHtcclxuICAgICAgICAgIHRoaXMucGF1c2UoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5wbGF5KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKHRoaXMucHJlbG9hZCA9PT0gJ25vbmUnKSB7XHJcbiAgICAgICAgLy8gSWYgcGxheWVyIGNhbid0IGJlIHBsYXllZCwgYmVjYXVzZSBhdWRpbyB3YXNuJ3QgcHJlLWxvYWRlZFxyXG4gICAgICAgIC8vIGR1ZSB0byB0aGUgcHJlbG9hZD1cIm5vbmVcIiBwcm9wZXJ0eSBzZXQsXHJcbiAgICAgICAgLy8gbG9hZCB0aGUgYXVkaW8gZmlsZSBhdCB0aGlzIHBvaW50IGFuZCBzdGFydCBwbGF5aW5nIGl0IGltbWVkaWF0ZWx5XHJcbiAgICAgICAgdGhpcy5hdWRpby5sb2FkKCk7XHJcbiAgICAgICAgdGhpcy5wbGF5KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzdG9wQWxsUGxheWVycyhjdXJyZW50KXtcclxuICAgICAgZm9yKGxldCBwbGF5ZXIgb2Ygd2luZG93LnBvZGNhc3RfcGxheWVycyl7XHJcbiAgICAgICAgaWYocGxheWVyICE9IGN1cnJlbnQpe1xyXG4gICAgICAgICAgcGxheWVyLnBvZGNhc3RwbGF5ZXIucGF1c2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBcclxuICAgIHBsYXkoKSB7XHJcbiAgICAgIGlmKCF0aGlzLnBsYXllci5jbGFzc0xpc3QuY29udGFpbnMoJ3BsYXllZCcpKXtcclxuICAgICAgICB0aGlzLnBsYXllci5jbGFzc0xpc3QuYWRkKCdwbGF5ZWQnKTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLnN0b3BBbGxQbGF5ZXJzKHRoaXMucGxheWVyKTtcclxuICAgICAgdGhpcy5wbGF5ZXIuY2xhc3NMaXN0LmFkZCgncGxheWluZycpO1xyXG4gICAgICB0aGlzLmF1ZGlvLnBsYXkoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcGF1c2UoKSB7XHJcbiAgICAgIHRoaXMucGxheWVyLmNsYXNzTGlzdC5yZW1vdmUoJ3BsYXlpbmcnKTtcclxuICAgICAgdGhpcy5hdWRpby5wYXVzZSgpO1xyXG4gICAgfVxyXG4gIFxyXG4gIFxyXG4gICAgLy8gUmVzdGFydCBhdWRpb1xyXG4gICAgcmVzdGFydChlKXtcclxuICAgICAgaWYgKCEhZSkgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIFxyXG4gICAgICB0aGlzLmN1cnJlbnRUaW1lID0gMDtcclxuICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykgdGhpcy5wbGF5KCk7XHJcbiAgICB9XHJcbiAgXHJcbiAgXHJcbiAgICAvLyB3aGVuIGF1ZGlvIGZpbGUgY2FuIGJlIHBsYXllZCBpbiB1c2VyJ3MgYnJvd3NlclxyXG4gICAgb25DYW5QbGF5KCkge1xyXG4gICAgICB0aGlzLmNhbkJlUGxheWVkID0gdHJ1ZTtcclxuICAgICAgdGhpcy50aW1lTGVmdCA9IHRoaXMuYXVkaW8uZHVyYXRpb247XHJcbiAgICAgIHZhciBwZXJjZW50YWdlUGxheWVkID0gMDtcclxuICBcclxuICAgICAgLy8gSWYgcGxheWVyIGhhcyBhIHRpbWUgb2Zmc2V0IHNwZWNpZmllZFxyXG4gICAgICAvLyBzdHlsZSB0aGUgcHJvZ3Jlc3MgYmFyIGFuZCB0aXRsZSBhY2NvcmRpbmdseVxyXG4gICAgICBpZiAodGhpcy50aW1lT2Zmc2V0ID4gMCkge1xyXG4gICAgICAgIHZhciBwZXJjZW50YWdlUGxheWVkID0gdGhpcy50aW1lT2Zmc2V0IC8gdGhpcy5hdWRpby5kdXJhdGlvbjtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICB0aGlzLnVwZGF0ZVZpc3VhbFByb2dyZXNzKHBlcmNlbnRhZ2VQbGF5ZWQpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgLy8gd2hlbiBwbGF5ZXIgc3RhcnRzIHBsYXlpbmdcclxuICAgIG9uUGxheWluZygpe1xyXG4gICAgICB0aGlzLmVuZGVkID0gZmFsc2U7XHJcbiAgICAgIHRoaXMuaXNQbGF5aW5nID0gdHJ1ZTtcclxuICAgICAgdGhpcy5zdGFydFByb2dyZXNzVGltZXIoKTtcclxuICAgIH1cclxuICBcclxuICBcclxuICAgIC8vIHN0YXJ0cyB0aW1lclxyXG4gICAgc3RhcnRQcm9ncmVzc1RpbWVyKCkge1xyXG4gICAgICB0aGlzLnRpbWVyID0ge307XHJcbiAgXHJcbiAgICAgIGlmICh0aGlzLnRpbWVyLnNsaWRlclVwZGF0ZUludGVydmFsKSB7XHJcbiAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyLnNsaWRlclVwZGF0ZUludGVydmFsKTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICB0aGlzLnRpbWVyLnNsaWRlclVwZGF0ZUludGVydmFsID0gc2V0SW50ZXJ2YWwoICgpID0+IHtcclxuICAgICAgICBpZiAoIHRoaXMuaXNQbGF5aW5nICkge1xyXG4gICAgICAgICAgdGhpcy5jdXJyZW50VGltZSA9IHRoaXMuYXVkaW8uY3VycmVudFRpbWU7XHJcbiAgICAgICAgICB0aGlzLnRpbWVMZWZ0ID0gdGhpcy5hdWRpby5kdXJhdGlvbiAtIHRoaXMuY3VycmVudFRpbWU7XHJcbiAgICAgICAgICB2YXIgcGVyY2VudGFnZVBsYXllZCA9IHRoaXMuY3VycmVudFRpbWUgLyB0aGlzLmF1ZGlvLmR1cmF0aW9uO1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVWaXN1YWxQcm9ncmVzcyhwZXJjZW50YWdlUGxheWVkKTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVyLnNsaWRlclVwZGF0ZUludGVydmFsKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0sIDYwKTtcclxuICAgIH1cclxuICBcclxuICBcclxuICAgIC8vIHdoZW4gUGxheWVyIGlzIHBhdXNlZFxyXG4gICAgb25QYXVzZSgpIHtcclxuICAgICAgdGhpcy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgIH1cclxuICBcclxuICBcclxuICAgIC8vIHdoZW4gUGxheWVyIGVuZGVkIHBsYXlpbmcgYW4gYXVkaW8gZmlsZVxyXG4gICAgb25FbmQoKSB7XHJcbiAgICAgIHRoaXMuZW5kZWQgPSB0cnVlO1xyXG4gICAgICB0aGlzLmlzUGxheWluZyA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIFxyXG4gIFxyXG4gICAgLy8gb24gZmlsZSBsb2FkIGVycm9yXHJcbiAgICBvbkVycm9yKCkge1xyXG4gICAgICB0aGlzLnBsYXllci5jbGFzc0xpc3QuYWRkKCdjYW50cGxheScpO1xyXG4gICAgICB0aGlzLmVycm9yID0gdHJ1ZTtcclxuICAgICAgdGhpcy5wbGF5ZXIuc2V0QXR0cmlidXRlKCdhcmlhLWludmFsaWQnLCAndHJ1ZScpO1xyXG4gICAgfVxyXG4gIFxyXG4gIFxyXG4gICAgLy8gdG8gY29udmVydCBzZWNvbmRzIHRvICdtOnNzJyBmb3JtYXRcclxuICAgIGNvbnZlcnRTZWNUb01pbihzZWNvbmRzKXtcclxuICAgICAgaWYgKHNlY29uZHMgPT09IDApIHJldHVybiAnMDowMCc7XHJcbiAgICAgIHZhciBtaW51dGVzID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gNjApO1xyXG4gICAgICB2YXIgc2Vjb25kc1RvQ2FsYyA9IE1hdGguZmxvb3Ioc2Vjb25kcyAlIDYwKSArICcnO1xyXG4gICAgICByZXR1cm4gbWludXRlcyArICc6JyArIChzZWNvbmRzVG9DYWxjLmxlbmd0aCA8IDIgPyAnMCcgKyBzZWNvbmRzVG9DYWxjIDogc2Vjb25kc1RvQ2FsYyk7XHJcbiAgICB9XHJcbiAgXHJcbiAgXHJcbiAgICAvLyBXaGVuIHVzZXIgY2xpY2tzIHNvbWV3aGVyZSBvbiB0aGUgcHJvZ3Jlc3MgYmFyXHJcbiAgICBiYXJDbGljayhlKSB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICBcclxuICAgICAgaWYgKHRoaXMuY2FuQmVQbGF5ZWQpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzQmFyKGUpO1xyXG4gICAgICAgIGlmICghdGhpcy5pc1BsYXlpbmcpIHtcclxuICAgICAgICAgIHRoaXMucGxheSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBlbHNlIGlmICh0aGlzLnByZWxvYWQgPT09ICdub25lJykge1xyXG4gICAgICAgIHRoaXMuYXVkaW8ubG9hZCgpO1xyXG4gICAgICAgIHRoaXMuYXVkaW8uYWRkRXZlbnRMaXN0ZW5lcignbG9hZGVkbWV0YWRhdGEnLCAoKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZVByb2dyZXNzQmFyKGUpO1xyXG4gICAgICAgICAgaWYgKCF0aGlzLmlzUGxheWluZykge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXkoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9LCBmYWxzZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICBcclxuXHJcbiAgICAvLyBIZWxwZXIgZnVuY3Rpb25cclxuICAgIC8vIHRoYXQgcmVjYWxjdWxhdGVzIHRoZSBwcm9ncmVzcyBiYXIgcG9zaXRpb25cclxuICAgIC8vIGJhc2VkIG9uIHRoZSBldmVudC5jbGljayBwb3NpdGlvblxyXG4gICAgdXBkYXRlUHJvZ3Jlc3NCYXIoZSkge1xyXG4gICAgICB2YXIgeCA9IGUueCAtIHRoaXMuYmFyLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XHJcbiAgICAgIHZhciByID0gKHggLyB0aGlzLmJhci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCkgKiB0aGlzLmF1ZGlvLmR1cmF0aW9uO1xyXG4gICAgICB0aGlzLnVwZGF0ZVBsYXlQb3NpdGlvbihyKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAvLyBIZWxwZXIgZnVuY3Rpb25cclxuICAgIC8vIHVwZGF0ZXMgdGhlIGN1cnJlbnQgdGltZSBiYXNlZCBvbiBhIHRpbWUgdmFyaWFibGVcclxuICAgIHVwZGF0ZVBsYXlQb3NpdGlvbihuZXdUaW1lKSB7XHJcbiAgICAgIHRoaXMuY3VycmVudFRpbWUgPSB0aGlzLmF1ZGlvLmN1cnJlbnRUaW1lID0gbmV3VGltZTtcclxuICAgICAgdmFyIHBlcmNlbnRhZ2VQbGF5ZWQgPSB0aGlzLmN1cnJlbnRUaW1lIC8gdGhpcy5hdWRpby5kdXJhdGlvbjtcclxuICAgICAgdGhpcy51cGRhdGVWaXN1YWxQcm9ncmVzcyhwZXJjZW50YWdlUGxheWVkKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgXHJcbiAgICAvLyBIZWxwZXIgZnVuY3Rpb25cclxuICAgIC8vIHVwZGF0ZXMgdGhlIHByb2dyZXNzIGJhciBiYXNlZCBvbiBhIHBlcmNlbnRhZ2UgcGxheWVkXHJcbiAgICB1cGRhdGVWaXN1YWxQcm9ncmVzcyhwZXJjZW50YWdlUGxheWVkKSB7XHJcbiAgICAgIHRoaXMucHJvZ3Jlc3Muc3R5bGUud2lkdGggPSAocGVyY2VudGFnZVBsYXllZCAqIDEwMCkgKyAnJSc7XHJcbiAgICAgIHRoaXMudGltZS5pbm5lckhUTUwgPSB0aGlzLmNvbnZlcnRTZWNUb01pbih0aGlzLnRpbWVMZWZ0KTtcclxuICAgIH1cclxuICBcclxuICB9OyIsImltcG9ydCB7IFBvZGNhc3RQbGF5ZXIgfSBmcm9tICcuL3BsYXllcidcclxuXHJcbnZhciBkb2NSZWFkeSA9IGZ1bmN0aW9uKCl7XHJcbiAgbGV0IHBsYXllcnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9kY2FzdC1wbGF5ZXInKTtcclxuICBmb3IodmFyIHBsYXllciBvZiBwbGF5ZXJzKXtcclxuICAgIHZhciBwbGF5ZXIgPSBuZXcgUG9kY2FzdFBsYXllcihwbGF5ZXIpO1xyXG4gIH1cclxufTtcclxuXHJcblxyXG5pZiAoIGRvY3VtZW50LnJlYWR5U3RhdGUgPT09ICdjb21wbGV0ZScgfHwgKGRvY3VtZW50LnJlYWR5U3RhdGUgIT09ICdsb2FkaW5nJyAmJiAhZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsKSkge1xyXG4gIGRvY1JlYWR5KCk7XHJcbn0gXHJcbmVsc2Uge1xyXG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBkb2NSZWFkeSk7XHJcbn1cclxuXHJcbiJdfQ=="}